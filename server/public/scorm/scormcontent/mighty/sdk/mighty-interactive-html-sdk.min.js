var n=["MIGHTY_INTERACTIVE_LOADED","MIGHTY_INTERACTIVE_HEIGHT_REPORT","MIGHTY_INTERACTIVE_CSS_JS_REPORT","MIGHTY_INTERACTIVE_HTML_REPORT","MIGHTY_INTERACTIVE_READY","MIGHTY_INTERACTIVE_COMPLETE","MIGHTY_INTERACTIVE_GET_ZIP_FILE","MIGHTY_INTERACTIVE_SEND_ZIP_FILE","MIGHTY_INTERACTIVE_DYNAMIC_FORM_CONFIG","MIGHTY_INTERACTIVE_RELOAD_REQUESTED","MIGHTY_INTERACTIVE_SDK_HOST_PING","MIGHTY_INTERACTIVE_SDK_HOST_PONG","MIGHTY_INTERACTIVE_SDK_STATE_REQUESTED","MIGHTY_INTERACTIVE_SDK_STATE_PROVIDED"];function E(s){return typeof s=="object"&&s!==null&&typeof s.data=="object"&&s.data!==null&&n.includes(s.data.type)}var o=class{constructor(){this.messageHandlers=new Map,this.listenToPostMessagesRelatedToSDK()}onMessageReceived(e,t){return this.messageHandlers.has(e)||this.messageHandlers.set(e,new Set),this.messageHandlers.get(e)?.add(t),()=>{this.messageHandlers.get(e)?.delete(t)}}sendHostPingMessage(){this.postMessageToInteractiveBlockWindow({type:"MIGHTY_INTERACTIVE_SDK_HOST_PING"})}sendStateRequestedMessage(e){this.postMessageToInteractiveBlockWindow({type:"MIGHTY_INTERACTIVE_SDK_STATE_REQUESTED",data:{defaultState:e}})}sendMarkAsCompleteMessage(){this.postMessageToInteractiveBlockWindow({type:"MIGHTY_INTERACTIVE_COMPLETE"})}listenToPostMessagesRelatedToSDK(){window.addEventListener("message",e=>{if(E(e)){let t=e.data.type;switch(t){case"MIGHTY_INTERACTIVE_SDK_HOST_PONG":this.handleMessageReceived(t);break;case"MIGHTY_INTERACTIVE_SDK_STATE_PROVIDED":this.handleMessageReceived(t,e.data.data.state);break}}})}postMessageToInteractiveBlockWindow(e){window.parent!==window&&window.parent.postMessage(e,"*")}handleMessageReceived(e,t){let r=this.messageHandlers.get(e);r&&r.forEach(I=>{I(t??void 0)})}};var a=class{getState(e,t){return e}};var T=class{constructor(e){this.messenger=e}async getState(e,t){return new Promise(r=>{this.messenger.onMessageReceived("MIGHTY_INTERACTIVE_SDK_STATE_PROVIDED",I=>{r(I)}),setTimeout(()=>{this.messenger.sendStateRequestedMessage(e),t&&setTimeout(()=>{r(e)},t)},0)})}};var i=class{constructor(){this.version="0.0.1";this.sdkIsReady=!1,this.messenger=new o,this.useNoOpMode=!1}async initialize(){await this.checkForHost()||(this.useNoOpMode=!0),this.useNoOpMode?this.state=new a:this.state=new T(this.messenger),this.sdkIsReady=!0,this.sdkReadyFn?.()}onSdkReady(e){this.sdkReadyFn=e,this.sdkIsReady&&e()}markAsComplete(){this.messenger.sendMarkAsCompleteMessage()}checkForHost(){return new Promise(e=>{this.messenger.onMessageReceived("MIGHTY_INTERACTIVE_SDK_HOST_PONG",()=>{e(!0)}),setTimeout(()=>{this.messenger.sendHostPingMessage(),setTimeout(()=>{e(!1)},100)},0)})}};var _=new i;window.mighty=window.mighty||{};window.mighty.interactiveHtmlSDK=_;_.initialize();
